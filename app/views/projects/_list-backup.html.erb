<h1>
  <% if scope.present? -%>
    <%= t("views.projects.#{scope}").html_safe -%>
  <% else -%>
    <% if @doc %>
      <% if @doc.has_divs? %>
        <%= t('views.projects.that_annotate_a_division', :href => projects_path, :serial => @doc.serial, :sourcedb => @doc.sourcedb, :sourceid => @doc.sourceid).html_safe %>
      <% else %>
        <%= t('views.projects.that_annotate_a_doc', :href => projects_path, :sourcedb => @doc.sourcedb, :sourceid => @doc.sourceid).html_safe %>
      <% end %>
	  <% else %>
    	<%= t('views.projects.in_pubannotation').html_safe %>
    	<% new_path = new_project_path -%>
	  <% end %>
  <% end %>
</h1>

<% if params[:action] == 'index' -%>
  <% if user_signed_in?%>
      <span class="button"><%= link_to t('views.shared.create_model', :model => t("activerecord.models.project")), new_path %></span>
  <% else %>
    <span class="button"><%= link_to t('views.users.sign_in_to_create_model', :model => t('activerecord.models.project')), new_user_session_path %></span>
  <% end %>
<% end %>

<%= link_to_if (params[:controller] == 'projects' && params[:action] == 'index' && (params[:sort_direction].present? || params[:search_projects])) || params[:controller] == 'home', t('views.projects.list'), projects_path, {class: 'tab inactive_tab'} do
  nil
end -%>

<%= render :partial => 'projects/search_form' if params[:controller] == 'projects' -%>

<% if projects.blank? %>
  <p>none</p>
<% else %>
  <div style="float:right">
    <%= total_number(projects, 'projects') -%>
  </div>

  <table class="full">
    <tr>
      <% if @annotations_projects_check -%>
        <th style="width:1.7em"></th>
      <% end -%>
      <th class="projects_header_name"><%= sortable(Project, 'name', t('activerecord.attributes.project.name')) %></th>
      <th><%= t('activerecord.attributes.project.description') %></th>
      <th class="projects_header_denotations_count"><%= sortable(Project, 'denotations_count', '#Denotations') -%></th>
      <th class="projects_header_author"><%= sortable(Project, 'author', t('activerecord.attributes.project.author')) %></th>
      <th class="projects_header_user"><%= sortable(Project, 'users.username', t('activerecord.attributes.project.maintainer')) -%></th>
      <th style="width:8em"><%= sortable(Project, 'projects.updated_at', t('activerecord.attributes.project.updated_at')) -%></th>
      <th style="width:8em"><%= sortable(Project, 'status', t('activerecord.attributes.project.status')) -%></th>
    </tr>

  <% projects.each do |project| %>
    <% project_path = project_path(project.name) -%>
    <tr>
      <% if @annotations_projects_check -%>
        <td><%= check_box_tag "annotations_projects_check", project.name, false, {id: "project_for_annotations_#{project.id}", class: 'annotations_projects_check'} -%></td>
      <% end -%>
      <td>
        <%= link_to_project(project) -%>
      </td>
      <td title="<%= project.description -%>"><%= project.description %></td>
      <td style="text-align:right"><%= denotations_count_helper(project, @doc, @span) -%></td>
      <td><%= project.author %></td>
      <td><%= project.user.username %></td>
      <td><%= project.updated_at.strftime('%Y-%m-%d') -%></td>
      <td><%= project.status_text -%></td>
    </tr>
  <% end %>
  </table>

	<%= will_paginate @projects if @projects.respond_to?('total_pages') -%>
<% end %>
