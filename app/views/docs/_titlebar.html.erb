<h1>
	<% if @project.present? -%>
		<%= link_to "#{@doc.sourcedb}:#{@doc.sourceid}", show_project_sourcedb_sourceid_docs_path(@project.name, @doc.sourcedb, @doc.sourceid) -%>
	<% else -%>
		<%= link_to "#{@doc.sourcedb}:#{@doc.sourceid}", doc_sourcedb_sourceid_show_path(@doc.sourcedb, @doc.sourceid) -%>
	<% end -%>
	<% if params[:divid].present? %>
		<% if @project.present? -%>
			(<%= link_to_unless_current "#{params[:divid]}", show_project_sourcedb_sourceid_divs_docs_path(@project.name, @doc.sourcedb, @doc.sourceid, params[:divid]) -%>)
		<% else -%>
			(<%= link_to_unless_current "#{params[:divid]}", doc_sourcedb_sourceid_divs_show_path(@doc.sourcedb, @doc.sourceid, params[:divid]) -%>)
		<% end -%>
	<% end %>
	<% if @span.present? %>
		/
		<%= "#{@span[:begin]}-#{@span[:end]}" %>
	<% end %>
	<span class='tab-bar'>
<!--		<span class='label'>UTF</span>
		<%= link_to_unless_current 'VIEW', params, :class => 'tab' -%>-->
    <%= json_text_link_helper.html_safe -%>
	</span>
<!--
	<span class='tab-bar'>
		<span class='label'>ASCII</span>
		<%= link_to_unless_current 'VIEW', params.merge(encoding: 'ascii'), :class => 'tab' -%>
		<%= link_to_unless_current 'JSON', params.merge(format: :json, encoding: 'ascii'), :class => 'tab' -%>
		<%= link_to_unless_current 'TXT', params.merge(format: :txt, encoding: 'ascii'), :class => 'tab' -%>
	</span>
	-->
	<span class='tab-bar'>
		<%= link_to '<', @prev_path, class: 'tab', title: 'previous division' unless @prev_path.nil? %>
		<%= link_to '>', @next_path, class: 'tab', title: 'next division' unless @next_path.nil? %>
	</span>

	<%=
		if @project.present?
			num_projects = if @span.present?
				annotations = @doc.hannotations(@projects, @span)
				annotations[:tracks].length
			else
				@doc.projects.length
			end

			title = if @span.present?
				"Click this button to see all the #{num_projects} projects that have annotations to this span."
			else
				"Click this button to see all the #{num_projects} projects that include this document."
			end

			if @doc.projects.length > 0
				if params[:divid].present?
					if @span.present?
						link_to("#{num_projects} Projects", doc_sourcedb_sourceid_divs_span_show_path(@doc.sourcedb, @doc.sourceid, params[:divid], params[:begin], params[:end]), :class => :button, title: title)
					else
						link_to("#{num_projects} Projects", doc_sourcedb_sourceid_divs_show_path(@doc.sourcedb, @doc.sourceid, params[:divid]), :class => :button, title: title)
					end
				else
					if @span.present?
						link_to("#{num_projects} Projects", doc_sourcedb_sourceid_span_show_path(@doc.sourcedb, @doc.sourceid, params[:begin], params[:end]), :class => :button, title: title)
					else
						link_to("#{num_projects} Projects", doc_sourcedb_sourceid_show_path(@doc.sourcedb, @doc.sourceid), :class => :button, title: title)
					end
				end
			end
		end
	%>

	<% if @project.present? && @project.editable?(current_user) && !params[:divid].present? -%>
		<span class='tab-bar'>
			<%= link_to t('views.shared.delete'), delete_project_sourcedb_sourceid_docs_path(@project.name, @doc.sourcedb, @doc.sourceid), method: 'delete', confirm: t('controllers.shared.confirm_delete'), class: 'button' -%>
		</span>
	<% end -%>
</h1>
