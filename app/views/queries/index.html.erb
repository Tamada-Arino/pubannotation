<section>

<% if @project %>
  <%= render :partial => 'projects/titlebar' -%>
<% end %>

<h1>Queries</h1>

<%=
  grid(@queries_grid) do |g|

    g.column name: 'Title', attribute: 'title' do |query|
      [link_to(query.title, query), {style: 'width:10em'}]
    end

    if root_user?
      g.column name: 'Cat.', attribute: 'category' do |query|
        [query.category, {style: 'width:4em; text-align:center'}]
      end
    end

    g.column name: 'Act?', attribute: 'active' do |query|
      [query.active, {style: 'width:4em; text-align:center'}]
    end

    g.column name: 'Pri.', attribute: 'priority' do |query|
      [query.priority, {style: 'width:4em; text-align:center'}]
    end

    unless @project
      g.column name: 'Project', attribute: 'project_id' do |query|
        [query.project ? query.project.name : '-', {style: 'width:4em; text-align:center'}]
      end
    end
  end
-%>

<br />

<% if @project && @project.editable?(current_user) %>
  <%= link_to "Create", new_project_query_path(@project.name), class: 'button' %>
<% elsif current_user && current_user.root %>
  <%= link_to "Create", new_query_path, class: 'button' %>
<% end %>

</section>